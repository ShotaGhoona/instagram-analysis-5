# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: Instagramåˆ†æã‚¢ãƒ—ãƒªï¼ˆPoCï¼‰  
**å¯¾è±¡**: 1-3äººã€100Instagramã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†  
**ã‚¹ã‚¿ãƒƒã‚¯**: FastAPI + Supabase + Next.js

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js       â”‚â”€â”€â”€â”€â”‚   FastAPI    â”‚â”€â”€â”€â”€â”‚   Supabase      â”‚
â”‚   (Frontend)    â”‚    â”‚  (Backend)   â”‚    â”‚  (Database)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ GitHub Actions  â”‚
                    â”‚ (Data Collector)â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚Instagram Graph  â”‚
                    â”‚      API        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆSupabaseï¼‰

### ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ 
```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆè¶…ã‚·ãƒ³ãƒ—ãƒ«ï¼‰
users (id, username, password_hash, created_at)

-- Instagramã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†
instagram_accounts (
  id, name, ig_user_id, access_token, 
  username, profile_picture_url, created_at
)

-- æ—¥æ¬¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆçµ±è¨ˆ
daily_account_stats (
  date, ig_user_id, followers_count, follows_count, 
  media_count, profile_views, website_clicks
)

-- æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿
media_posts (
  ig_media_id, ig_user_id, timestamp, media_type,
  caption, media_url, thumbnail_url, permalink
)

-- æ—¥æ¬¡æŠ•ç¨¿çµ±è¨ˆ
daily_media_stats (
  date, ig_media_id, like_count, comments_count,
  reach, views, shares, saved
)
```

## ğŸ”§ FastAPIãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ§‹æˆï¼ˆClean Architectureï¼‰

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 
```
backend/
â”œâ”€â”€ main.py                      # FastAPI ã‚¢ãƒ—ãƒªèµ·ç‚¹
â”œâ”€â”€ requirements.txt
â”œâ”€â”€
â”œâ”€â”€ core/                        # ã‚³ã‚¢è¨­å®šãƒ»å…±é€šæ©Ÿèƒ½
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py               # ç’°å¢ƒå¤‰æ•°ãƒ»è¨­å®šç®¡ç†
â”‚   â””â”€â”€ database.py             # Supabaseæ¥ç¶šã®ã¿
â”‚
â”œâ”€â”€ models/                      # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆPydanticï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ user.py                 # User model
â”‚   â”œâ”€â”€ instagram.py            # Instagramé–¢é€£models
â”‚   â””â”€â”€ analytics.py            # Analyticsé–¢é€£models
â”‚
â”œâ”€â”€ repositories/                # ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ï¼ˆCRUDæ“ä½œï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                 # BaseRepository
â”‚   â”œâ”€â”€ user_repository.py      # User CRUD
â”‚   â”œâ”€â”€ instagram_repository.py # Instagram Account CRUD
â”‚   â””â”€â”€ analytics_repository.py # Analytics CRUD
â”‚
â”œâ”€â”€ services/                    # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth_service.py         # èªè¨¼ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ instagram_service.py    # Instagramçµ±åˆãƒ­ã‚¸ãƒƒã‚¯
â”‚   â””â”€â”€ analytics_service.py    # åˆ†æãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯
â”‚
â”œâ”€â”€ api/                         # FastAPI ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ auth.py                 # èªè¨¼APIï¼ˆæ—§auth/simple_auth.pyï¼‰
â”‚   â”œâ”€â”€ accounts.py             # ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†API
â”‚   â”œâ”€â”€ setup.py                # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†API
â”‚   â”œâ”€â”€ analytics.py            # åˆ†æãƒ‡ãƒ¼ã‚¿API
â”‚   â””â”€â”€ media.py                # æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿API
â”‚
â”œâ”€â”€ external/                    # å¤–éƒ¨APIçµ±åˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ instagram_client.py     # Instagram APIçµ±åˆ
â”‚
â””â”€â”€ sql/                        # SQLã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    â”œâ”€â”€ create_tables.sql
    â””â”€â”€ sample_data.sql
```

### Clean Architecture å„å±¤ã®è²¬ä»»

#### 1. **models/** - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±¤ï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼‰
- Pydanticãƒ¢ãƒ‡ãƒ«ã®å®šç¾©ã®ã¿
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯å«ã¾ãªã„
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã®å®šç¾©

#### 2. **repositories/** - ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹CRUDæ“ä½œã®ã¿
- SQLã‚¯ã‚¨ãƒªã®å®Ÿè¡Œ
- ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã®å¤‰æ›

#### 3. **services/** - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼‰
- è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè£…
- è¤‡æ•°ã®Repositoryã®çµ„ã¿åˆã‚ã›
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†

#### 4. **api/** - ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼‰
- HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å‡¦ç†
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- Serviceã®å‘¼ã³å‡ºã—ã®ã¿

#### 5. **external/** - å¤–éƒ¨çµ±åˆå±¤
- Instagram APIç­‰ã®å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº
- å¤–éƒ¨APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å®Ÿè£…

### ä¸»è¦API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
```python
# èªè¨¼
POST /auth/login
POST /auth/logout

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ï¼‰
POST /setup/refresh-tokens    # å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒ»æ–°è¦è¿½åŠ 

# ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†
GET  /accounts          # å…¨Instagramã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§
GET  /accounts/{id}     # å€‹åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè©³ç´°

# åˆ†æãƒ‡ãƒ¼ã‚¿
GET  /analytics/yearly/{account_id}   # å¹´é–“åˆ†æ
GET  /analytics/monthly/{account_id}  # æœˆé–“åˆ†æ  
GET  /analytics/posts/{account_id}    # æŠ•ç¨¿åˆ†æ

# æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿
GET  /media/{account_id}              # æŠ•ç¨¿ä¸€è¦§
GET  /media/{media_id}/insights       # æŠ•ç¨¿ã‚¤ãƒ³ã‚µã‚¤ãƒˆ
```

## ğŸ¤– GitHub Actions ãƒ‡ãƒ¼ã‚¿åé›†

### ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹æˆ
```yaml
# .github/workflows/data-collection.yml
name: Daily Instagram Data Collection
on:
  schedule:
    - cron: '0 9 * * *'  # æ¯æ—¥9æ™‚å®Ÿè¡Œ

jobs:
  collect:
    runs-on: ubuntu-latest
    steps:
      - name: ãƒ‡ãƒ¼ã‚¿åé›†ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œ
        run: python scripts/daily_collector.py
      - name: Supabaseã¸ãƒ‡ãƒ¼ã‚¿ä¿å­˜
        run: python scripts/save_to_database.py
```

### ãƒ‡ãƒ¼ã‚¿åé›†ãƒ•ãƒ­ãƒ¼
1. **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåŸºæœ¬æƒ…å ±æ›´æ–°** (æ—¥1å›)
2. **æ–°è¦æŠ•ç¨¿æ¤œå‡ºãƒ»ä¿å­˜** (æŠ•ç¨¿æ¯)
3. **æŠ•ç¨¿ã‚¤ãƒ³ã‚µã‚¤ãƒˆå–å¾—** (æŠ•ç¨¿æ¯)
4. **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã‚¤ãƒ³ã‚µã‚¤ãƒˆå–å¾—** (æ—¥1å›)

## ğŸ¯ å®Ÿè£…å„ªå…ˆåº¦

### Phase 1: åŸºç›¤æ§‹ç¯‰
1. âœ… **Supabase ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
2. âœ… **FastAPI åŸºæœ¬æ§‹æˆ**
3. âœ… **ã‚·ãƒ³ãƒ—ãƒ«èªè¨¼å®Ÿè£…**
4. âœ… **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–**

### Phase 2: ãƒ‡ãƒ¼ã‚¿åé›†
1. âœ… **GitHub Actions ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
2. âœ… **Instagram API çµ±åˆ**
3. âœ… **æ¯æ—¥ãƒ‡ãƒ¼ã‚¿åé›†è‡ªå‹•åŒ–**

### Phase 3: åˆ†æAPI
1. âœ… **æŠ•ç¨¿åˆ†æã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
2. âœ… **å¹´é–“/æœˆé–“åˆ†æã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**
3. âœ… **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**

## ğŸ”„ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æˆ¦ç•¥

### æ®µéšçš„ç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
1. **Phase 1**: æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ä½œæˆ
2. **Phase 2**: ãƒ¢ãƒ‡ãƒ«åˆ†é›¢ï¼ˆmodels/database.py â†’ models/*.pyï¼‰
3. **Phase 3**: Repositoryå±¤ä½œæˆãƒ»ç§»è¡Œ
4. **Phase 4**: Serviceå±¤ä½œæˆãƒ»ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ç§»è¡Œ
5. **Phase 5**: APIå±¤ã®ç°¡ç•¥åŒ–
6. **Phase 6**: æ—§ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ãƒ»å‹•ä½œç¢ºèª

### ä¾å­˜é–¢ä¿‚ã®æµã‚Œï¼ˆClean Architectureï¼‰
```
api/ â”€â”€â†’ services/ â”€â”€â†’ repositories/ â”€â”€â†’ models/
  â”‚                                        â†‘
  â””â”€â”€â”€â”€â”€â”€â†’ external/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åˆ©ç‚¹
- **å˜ä¸€è²¬ä»»ã®åŸå‰‡**: å„ã‚¯ãƒ©ã‚¹ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ˜ç¢ºãªå½¹å‰²ã‚’æŒã¤
- **ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§**: å„å±¤ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆå¯èƒ½
- **ä¿å®ˆæ€§å‘ä¸Š**: æ©Ÿèƒ½è¿½åŠ ãƒ»å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ãŒæ˜ç¢º
- **å¯èª­æ€§å‘ä¸Š**: ã‚³ãƒ¼ãƒ‰ã®æ‰€åœ¨ãŒäºˆæ¸¬ã—ã‚„ã™ã„

## âš¡ PoCãƒ¬ãƒ™ãƒ«æœ€é©åŒ–ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¾Œã‚‚ç¶­æŒï¼‰

### ã‚·ãƒ³ãƒ—ãƒ«åŒ–é …ç›®
- **èªè¨¼**: JWTä½¿ç”¨ã€ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: åŸºæœ¬çš„ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åŸºæœ¬çš„ãªãƒ­ã‚°å‡ºåŠ›ã®ã¿
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãªã—ï¼ˆç›´æ¥DB ã‚¯ã‚¨ãƒªï¼‰
- **éåŒæœŸå‡¦ç†**: åŸºæœ¬çš„ãªåŒæœŸå‡¦ç†ã§ã‚¹ã‚¿ãƒ¼ãƒˆ

### æŠ€è¡“é¸æŠç†ç”±
- **FastAPI**: è‡ªå‹•ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆã€å‹å®‰å…¨ã€ä¾å­˜æ³¨å…¥ã‚µãƒãƒ¼ãƒˆ
- **Supabase**: PostgreSQLã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ï¼ˆå°†æ¥æ‹¡å¼µå¯ï¼‰
- **GitHub Actions**: ç„¡æ–™æ ã€ç°¡å˜ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- **Clean Architecture**: å°†æ¥ã®æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ãŸè¨­è¨ˆ

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æˆ¦ç•¥

### é–‹ç™ºç’°å¢ƒ
- **Backend**: `uvicorn main:app --reload`
- **Frontend**: `npm run dev`
- **Database**: Supabase ã‚¯ãƒ©ã‚¦ãƒ‰

### æœ¬ç•ªç’°å¢ƒï¼ˆPoCï¼‰
- **Backend**: Vercel / Railway
- **Frontend**: Vercel
- **Database**: Supabase æœ¬ç•ªç’°å¢ƒ

**å®Ÿè£…æ™‚é–“è¦‹ç©**: Backend 3-5æ—¥ã€ãƒ‡ãƒ¼ã‚¿åé›† 2-3æ—¥ã€ãƒ†ã‚¹ãƒˆãƒ»çµ±åˆ 1-2æ—¥