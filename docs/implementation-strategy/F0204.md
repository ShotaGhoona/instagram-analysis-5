# F0204: パフォーマンス推移グラフ

## 概要
Rechartsを使用してInstagram投稿のパフォーマンス推移を可視化するグラフコンポーネントの実装。エンゲージメント率の線グラフと各指標の棒グラフを組み合わせる。

## 実装戦略

### 1. Recharts セットアップ (30分)
- Rechartsライブラリのインストール確認
- 必要なコンポーネントのimport整理
- `LineChart`, `BarChart`, `ResponsiveContainer`等

### 2. グラフデータ準備 (45分)
#### ダミーデータ拡張
- `mock-data.ts`のpostデータを時系列順に整理
- 8月の投稿を日付順でソート
- グラフ表示用のデータ変換関数作成

#### データ変換関数
- 投稿データをグラフ用フォーマットに変換
- x軸: 投稿日（8/5, 8/7, 8/8...）
- y軸1: いいね数、リーチ数、視聴数（棒グラフ）
- y軸2: エンゲージメント率（線グラフ）

### 3. グラフコンポーネント作成 (2時間)
#### PostsPerformanceChart コンポーネント
- `src/components/analytics/posts-performance-chart.tsx`作成
- 複合グラフ（棒グラフ + 線グラフ）実装
- レスポンシブコンテナで幅100%対応

#### グラフ仕様
- **棒グラフ（左軸）**: いいね（青）、リーチ（緑）、視聴数（黄）
- **線グラフ（右軸）**: エンゲージメント率（赤丸）
- **x軸**: 投稿日（MM/DD形式）
- **y軸左**: 数値（件数）
- **y軸右**: パーセンテージ（%）

### 4. レイアウト統合 (45分)
#### 投稿分析ページ統合
- PostsTableの下部にグラフエリア追加
- Card UIでグラフをラップ
- 高さ300px程度に設定

#### スタイリング調整
- グラフの色彩調整（ブランドカラー）
- 凡例の配置・表示
- グリッド線、ツールチップの設定

### 5. デザイン微調整 (30分)
- ページデザイン設計との整合性確認
- 余白、フォントサイズ調整
- グラフタイトル「パフォーマンス推移グラフ」追加

## 完了条件
- [ ] 複合グラフ（棒 + 線）が正常に表示される
- [ ] エンゲージメント率の線グラフが動作する
- [ ] いいね、リーチ、視聴数の棒グラフが表示される
- [ ] 投稿分析ページでレイアウトが整っている
- [ ] ツールチップで詳細データが確認できる
- [ ] レスポンシブコンテナで幅調整される

## PoC配慮
- **アニメーション無し**: シンプルな静的グラフ
- **インタラクション最小限**: ツールチップのみ
- **カスタマイズ機能無し**: 固定の表示項目
- **パフォーマンス最適化無し**: 基本実装のみ

## スコープ外機能
```tsx
// TODO: フィルタリング機能との連携（期間指定等）
// TODO: グラフの詳細設定UI（表示項目選択等）
// TODO: データエクスポート機能
// TODO: B0204 API統合後のリアルタイムデータ更新
```

## 技術詳細

### グラフデータ構造
```tsx
interface ChartDataPoint {
  date: string        // "8/5"
  likes: number       // いいね数
  reach: number       // リーチ数  
  views: number       // 視聴数
  engagementRate: number  // エンゲージメント率
}
```

### Recharts設定例
```tsx
<ResponsiveContainer width="100%" height={300}>
  <LineChart data={chartData}>
    <CartesianGrid strokeDasharray="3 3" />
    <XAxis dataKey="date" />
    <YAxis yAxisId="left" />
    <YAxis yAxisId="right" orientation="right" />
    
    {/* 棒グラフ */}
    <Bar yAxisId="left" dataKey="likes" fill="#8884d8" />
    <Bar yAxisId="left" dataKey="reach" fill="#82ca9d" />
    <Bar yAxisId="left" dataKey="views" fill="#ffc658" />
    
    {/* 線グラフ */}
    <Line yAxisId="right" dataKey="engagementRate" stroke="#ff7300" />
    
    <Tooltip />
    <Legend />
  </LineChart>
</ResponsiveContainer>
```

## パフォーマンス考慮
- データ数は15件程度の想定
- メモ化は不要（PoC範囲）
- グラフの再描画頻度は低い

## 参考
- [ページデザイン設計](../requirement-definition/03-page-design.md) - グラフレイアウト仕様
- [Recharts公式ドキュメント](https://recharts.org/en-US/)
- [既存utils.ts](../../frontend/src/lib/utils.ts) - エンゲージメント率計算