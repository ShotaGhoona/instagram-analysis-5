# D0051-D0054: 本番データ導入（CSV前提）

## 概要
instagram_accounts_rows.csvからの本番アカウントデータ導入と、GitHub Actions環境での日次データ収集実行・検証

## 前提条件
- `instagram_accounts_rows.csv` が準備済み（10アカウント分）
- CSVにはinstagram_user_id, username, account_name, access_token_encrypted等が含まれる
- 既存のテストアカウント（5件）は保持し、本番アカウントを追加する形式

## 実装戦略

### 1. CSVデータ解析・変換スクリプト作成 (30分)
- `scripts/import_production_accounts.py` 作成
- CSVからデータベーススキーマへの変換処理
- access_token_encryptedの復号化（必要に応じて）
- データバリデーション（instagram_user_id, usernameの重複チェック）

### 2. データベース投入・検証 (45分)
- CSVデータをSupabaseのinstagram_accountsテーブルに投入
- 既存5件 + 新規10件 = 合計15件のアカウント管理
- データ整合性確認（重複排除、必須フィールド検証）
- アクセストークン有効性の事前確認

### 3. GitHub Actions実行・本番テスト (60分)
- 本番アカウントでのdaily-data-collection.yml手動実行
- 15アカウント全てでのデータ収集成功確認
- media_posts, daily_media_stats, daily_account_statsテーブルの更新確認
- API制限・エラーハンドリングの動作確認

### 4. データ品質チェック・検証 (45分)
- 収集データの完全性確認（全アカウント・全投稿のデータ取得）
- 投稿インサイト数値の妥当性確認（reach, shares, saved等）
- 過去データとの整合性確認
- 異常値・欠損データの特定と対応

## 完了条件
- [ ] CSVから全10アカウントのデータベース投入完了
- [ ] GitHub Actions本番実行で15アカウント全てのデータ収集成功
- [ ] 投稿データ・インサイト・アカウント統計の3テーブル全て更新確認
- [ ] エラー0件での安定実行確認
- [ ] フロントエンドで本番データが正常表示されることの確認

## PoC配慮
- **セキュリティ**: アクセストークンの暗号化処理は簡易実装
- **エラーハンドリング**: 基本的な例外処理のみ（本格対応は後回し）
- **パフォーマンス**: 15アカウント程度での動作確認（大量アカウント対応は不要）
- **バックアップ**: 本格的なバックアップ機能は未実装

## 修正が必要なチェックリスト項目

### 現在の状況
```markdown
| D0051 | 本番Instagram API設定 | 実際のApp ID・Secret・Access Token設定 | 2時間 | ❌ 未完了 |
| D0052 | 実データ取得・検証 | 本番アカウントでのデータ収集テスト | 3時間 | ❌ 未完了 |
| D0053 | データ品質チェック | 取得データの整合性・完全性確認 | 2時間 | ❌ 未完了 |
| D0054 | 履歴データ補完 | 過去データの取得・バックフィル処理 | 1時間 | ❌ 未完了 |
```

### CSV前提での修正版
```markdown
| D0051 | 本番アカウントCSV投入 | instagram_accounts_rows.csvからDB投入 | 1.5時間 | ❌ 未完了 |
| D0052 | 実データ取得・検証 | 本番15アカウントでのデータ収集テスト | 2時間 | ❌ 未完了 |
| D0053 | データ品質チェック | 取得データの整合性・完全性確認 | 1.5時間 | ❌ 未完了 |
| D0054 | 本番運用確認 | GitHub Actions安定稼働・フロントエンド表示確認 | 1時間 | ❌ 未完了 |
```

## 実装手順
1. CSVインポートスクリプト作成・実行
2. データベース投入・確認
3. GitHub Actions本番実行・監視
4. データ品質確認・異常値チェック
5. フロントエンド表示確認
6. 安定稼働確認（定期実行テスト）

## 次のタスク
- フロントエンドでの本番データ表示確認
- PDFエクスポート機能の本番データ対応（F0541-F0544）
- 本番デプロイ設定（D0201-D0202）