# Instagram API 概要

Instagram プラットフォームは、ビジネスとクリエイターを含む Instagram プロフェッショナルアカウントのデータにアプリがアクセスできる API のコレクションです。自分の Instagram プロフェッショナルアカウントのみを提供するアプリを構築することも、所有・管理していない他の Instagram プロフェッショナルアカウントを提供するアプリを構築することもできます。

アプリで使用できる Instagram API 設定は2つあります：

| ビジネス向け Facebook ログイン付き Instagram API | Instagram ログイン付き Instagram API |
|---|---|
| Facebook ページにリンクされた Instagram プロフェッショナルアカウントを提供 | Instagram のみでプレゼンスを持つ Instagram プロフェッショナルアカウントを提供 |
| アプリユーザーは Facebook 認証情報を使ってログイン | アプリユーザーは Instagram 認証情報を使ってログイン |

選択した設定に応じて、アプリユーザーは顧客や Instagram プロフェッショナルアカウントに興味を持つ人々と会話し、メディアのコメントをモデレートし、プライベートリプライを送信し、コンテンツを公開し、広告を公開し、インサイトを取得できるようになります。

## どちらの API が適切ですか？

| コンポーネント | Instagram ログイン設定 | Facebook ログイン設定 |
|---|---|---|
| アクセストークンタイプ | Instagram ユーザー | Facebook ユーザーまたはページ |
| 認証タイプ | Instagram ビジネスログイン | ビジネス向け Facebook ログイン |
| コメントモデレーション | ✅ | ✅ |
| コンテンツ公開 | ✅ | ✅ |
| Facebook ページ | ❌ | 必須 |
| ハッシュタグ検索 | ❌ | ✅ |
| インサイト | ✅ | ✅ |
| メンション | ✅ | ✅ |
| メッセージング | ✅ | Messenger Platform 経由 |
| 商品タグ付け | ❌ | ✅ |
| パートナーシップ広告 | ❌ | ✅ |

## アクセスレベル

アプリには2つのアクセスレベルがあります：スタンダードアクセスとアドバンスアクセス。

### スタンダードアクセス

スタンダードアクセスはすべてのアプリのデフォルトアクセスレベルで、アプリが取得できるデータを制限します。役割を持つ人々のみが使用するアプリ、アプリ開発中、またはアプリのテスト用に意図されています。自分の Instagram プロフェッショナルアカウントまたは管理するアカウントのみを提供する場合、スタンダードアクセスで十分です。

### アドバンスアクセス

アドバンスアクセスは、所有・管理していない Instagram プロフェッショナルアカウントを提供し、アプリに役割を持たないユーザーや、アプリを請求したビジネスポートフォリオに役割を持たないユーザーが使用するアプリに必要なアクセスレベルです。このアクセスレベルにはアプリレビューとビジネス認証が必要です。

**注意**: スタンダードアクセスの限定された範囲のため、アプリがアドバンスアクセスを付与されるまで一部の機能が正常に動作しない場合があります。

## アプリレビュー

Meta アプリレビューにより、Meta はアプリが承認された方法で製品と API を使用していることを確認できます。アドバンスアクセスを付与されるには、アプリは Meta アプリレビューを完了する必要があります。

## プライベートアプリ

アプリがプライベートイントラネットの背後にある、ユーザーインターフェースがない、またはビジネス向け Facebook ログインを実装していないためにレビュアーがテストできない場合、以下の権限のみに対して承認をリクエストできます：

- `instagram_basic`
- `instagram_manage_comments`

## アプリユーザー

API を使用するには、アプリユーザーは Instagram プロフェッショナルアカウントを持っている必要があります。Instagram プロフェッショナルアカウントはビジネスまたはクリエイター用です。

## 認証と認可

エンドポイント認証は権限と機能を通じて処理されます。アプリがエンドポイントを使用してアプリユーザーの Instagram プロフェッショナルアカウントデータにアクセスする前に、まずそれらのエンドポイントに必要なすべての権限をアプリユーザーから要求する必要があります。

## 機能と権限

API は、ログインタイプに基づく以下の権限と機能を使用します：

### Instagram ログイン
- `instagram_business_basic`
- `instagram_business_content_publish`
- `instagram_business_manage_comments`
- `instagram_business_manage_messages`
- ヒューマンエージェント機能

### Facebook ログイン
- `instagram_basic`
- `instagram_content_publish`
- `instagram_manage_comments`
- `instagram_manage_insights`
- `instagram_manage_messages`
- `pages_show_list`
- `pages_read_engagement`
- ヒューマンエージェント機能
- Instagram 公開コンテンツアクセス機能

### ヒューマンエージェント機能

ヒューマンエージェント機能を使用すると、アプリでヒューマンエージェントが、`human_agent` タグを使用した利用者からのメッセージに対し、メッセージ受信から7日以内に返信できるようになります。

### Instagram 公開コンテンツへのアクセス機能

Instagram 公開コンテンツへのアクセス機能を使用すると、アプリは Instagram Graph API のハッシュタグ検索エンドポイントにアクセスできるようになります。この機能により許可される使用方法は、ハッシュタグキャンペーンに関連付けられたコンテンツの発見、ブランドに対する人々のセンチメント理解、またはコンテスト・大会・懸賞の参加者特定です。

## ベース URL

- **Instagram ログインを使用するアプリ**: `graph.instagram.com`
- **Facebook ログインを使用するアプリ**: `graph.facebook.com`

## ビジネス認証

アプリがアドバンスアクセスを必要とする場合、ビジネス認証を完了する必要があります。

## コメントモデレーション

Instagram ユーザーがアプリユーザーの Instagram プロフェッショナルアカウントのメディアにコメントすると、アプリは API を使用してコメントの取得、返信、削除、非表示/表示、コメントの無効化/有効化を行えます。

## コンテンツ公開

アプリは API を使用して、アプリユーザーの Instagram プロフェッショナルアカウントに代わって単一画像、動画、リール、または複数の画像と動画を含む投稿（カルーセル投稿）を公開できます。

## コラボレーター

**Facebook ログインでのビジネス向けのみ**

Instagram コラボレータータグを使用すると、Instagram ユーザーはコンテンツを共同作成できます（他のアカウントと一緒にメディアを公開）。

## Meta での開発

Meta テクノロジーAPI をアプリに統合する前に、Meta デベロッパーとして登録し、アプリを表す Meta アプリダッシュボードでアプリを作成する必要があります。

## アプリ ID

アプリ ID は認証中に必要で、アプリの Meta アプリダッシュボードで確認できます。

## Facebook ページ

アプリがビジネス向け Facebook ログインを実装する場合、アプリユーザーの Instagram プロフェッショナルアカウントは Facebook ページに接続されている必要があります。

## タスク

アプリユーザーは、Instagram プロフェッショナルアカウントにリンクされた Facebook ページでタスクを実行できる必要があります。

| UI でのタスク名 | API でのタスク名 | 付与可能な権限 |
|---|---|---|
| 広告 | `PROFILE_PLUS_ADVERTISE` | `instagram_basic` |
| コンテンツ | `PROFILE_PLUS_CREATE_CONTENT` | `instagram_basic`, `instagram_content_publish` |
| 完全制御 | `PROFILE_PLUS_FULL_CONTROL` | `instagram_basic`, `instagram_content_publish` |
| インサイト | `PROFILE_PLUS_ANALYZE` | `instagram_basic`, `instagram_manage_insights` |
| メッセージ | `PROFILE_PLUS_MESSAGING` | `instagram_basic`, `instagram_manage_messages` |
| コミュニティアクティビティ | `PROFILE_PLUS_MODERATE` | `instagram_basic`, `instagram_manage_comments` |

## スコープ付きユーザー ID

### Instagram スコープ付きユーザー ID

Instagram ユーザーが投稿、リール、ストーリーにコメントしたり、Instagram プロフェッショナルアカウントにメッセージを送信したりすると、そのアプリでのその人を表す Instagram スコープ付きユーザー ID が作成されます。

### ページスコープ付きユーザー ID

Instagram ユーザーが投稿、リール、ストーリーにコメントしたり、Instagram プロフェッショナルアカウントにメッセージを送信したりすると、そのアプリでのその人を表すページスコープ付きユーザー ID が作成されます。

## /me エンドポイント

`/me` エンドポイントは、現在 API 呼び出しに使用されているアクセストークンのアカウント、Facebook ページ、または Instagram プロフェッショナルアカウントのオブジェクト ID に変換される特別なエンドポイントです。

## メッセージング

Instagram ユーザーが Instagram にログインしながらアプリユーザーの Instagram プロフェッショナルアカウントにメッセージを送信すると、メッセージはアプリユーザーの Instagram 受信ボックスに配信され、Webhook 通知がサーバーに送信されます。アプリは API を使用して24時間以内に応答できます。

### Instagram 受信ボックス

Instagram プロフェッショナルアカウントには、通知を制御してメッセージを整理できるメッセージング受信ボックスがあります。受信ボックスは Primary、General、Requests の異なるカテゴリに整理されます。

### 自動化されたエクスペリエンス

以下のいずれかを使用して、自動化されたメッセージングエクスペリエンスのエスカレーションパスを提供できます：

- **単一アプリ** - 人からのメッセージを受信または返信するためのカスタム受信ボックスを作成
- **複数アプリ** - ハンドオーバープロトコルにより会話を1つのアプリまたは受信ボックスから別のものに引き渡し

### 自動化されたエクスペリエンスに関するユーザーへの通知

自動チャットエクスペリエンスは、適用される法律で求められている場合、利用者がやり取りしているのが実際には自動化サービスであることを以下のタイミングで明らかにしなければなりません：

- 会話またはメッセージ会話の最初
- かなり時間が経過した後
- ヒューマンエージェントとのやり取りから自動化エクスペリエンスにチャットが移行したとき

## ポリシー

Meta ソーシャルグラフへのアクセスを取得し維持するには、以下に従う必要があります：

- Instagram での自動チャット
- Meta プラットフォーム利用規約
- 開発者ポリシー
- コミュニティスタンダード
- 責任あるプラットフォームイニシアチブ

## レート制限

すべてのエンドポイントは Instagram ビジネス利用ケースレート制限の対象ですが、ビジネス発見とハッシュタグ検索エンドポイントはプラットフォームレート制限の対象です。

### 24時間内の呼び出し数の計算

```
24時間内の呼び出し数 = 4800 × インプレッション数
```

インプレッション数は、過去24時間以内にアプリユーザーの Instagram プロフェッショナルアカウントからのコンテンツが人の画面に表示された回数です。

### メッセージングレート制限

| API | 制限 |
|---|---|
| Conversations API | Instagram プロフェッショナルアカウントごとに1秒あたり2回 |
| Private Replies API (Live) | Instagram プロフェッショナルアカウントごとに1秒あたり100回 |
| Private Replies API (投稿/リール) | Instagram プロフェッショナルアカウントごとに1時間あたり750回 |
| Send API (テキスト/リンク等) | Instagram プロフェッショナルアカウントごとに1秒あたり100回 |
| Send API (音声/動画) | Instagram プロフェッショナルアカウントごとに1秒あたり10回 |

## Webhooks

アプリユーザーのメディアオブジェクトまたはメッセージに関する通知を受信するために Webhooks を使用することを強く推奨します。Webhooks を使用すると、アプリが行う必要のある API 呼び出し数が削減され、レート制限に達するリスクが軽減されます。

## 次のステップ

この API のコンポーネントに慣れたら、Webhooks サーバーをセットアップしてイベントをサブスクライブしてください。